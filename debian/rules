#!/usr/bin/make -f 

LDFLAGS+=-Wl,--as-needed

%:
	dh $@ --with autoreconf --fail-missing

override_dh_autoreconf:
	NOCONFIGURE=1 dh_autoreconf ./autogen.sh


override_dh_auto_build:
	dh_auto_build
	./src/logo-generator --logo data/logo-bare.png --text '14.04 LTS' --output logo.png

override_dh_auto_install:
	dh_auto_install
	cp logo.png debian/arctica-greeter/usr/share/arctica-greeter/logo.png
	mkdir -p debian/arctica-greeter/var/lib/polkit-1/localauthority/10-vendor.d/
	cp debian/arctica-greeter.pkla debian/arctica-greeter/var/lib/polkit-1/localauthority/10-vendor.d/
	mkdir -p debian/arctica-greeter/usr/share/lightdm/lightdm.conf.d/
	cp debian/50-arctica-greeter.conf debian/arctica-greeter/usr/share/lightdm/lightdm.conf.d/
	mkdir -p debian/arctica-greeter/etc/lightdm/lightdm.conf.d/
	cp debian/90-arctica-greeter.conf debian/arctica-greeter/etc/lightdm/lightdm.conf.d/

override_dh_auto_clean:
	dh_auto_clean
	rm -f logo.png

